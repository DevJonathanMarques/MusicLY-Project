<!DOCTYPE html>
<html>
<head>

	<meta charset="utf-8">

	<title>MusicLY</title>

	<link rel="icon" href="IMAGENS/icon.png">

	<link rel="stylesheet" type="text/css" href="estilo.css">

	<!-- CSS only -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

	<!-- JavaScript Bundle with Popper -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>

	<!-- Font Awesome - Icons -->
	<script src="https://kit.fontawesome.com/5d9c2ca835.js" crossorigin="anonymous"></script>

</head>
<body id="container">

	<!-- HEADER 1-->
	<header id="header1" class="container-fluid">
		<div class="row">
			<div class="col-4">
				<a href="" class="navbar-brand">
					<img src="IMAGENS/logo.png" class="img-fluid">
				</a>
			</div>

			<div class="col-7 d-flex justify-content-end">
				<nav class="nav navbar navbar-expand-sm">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item"><a href="" class="nav-link">Premium</a></li>
						<li class="nav-item"><a href="" class="nav-link">Ajuda</a></li>
						<li class="nav-item"><a href="" class="nav-link">Baixar</a></li>

						<li class="nav-item divisor"></li>

						<li class="nav-item"><a href="" class="nav-link">Inscrever-se</a></li>
						<li class="nav-item"><a href="" class="nav-link">Entrar</a></li>
					</ul>
				</nav>
			</div>
		</div>
	</header>

	<!-- HEADER 2-->
	<header id="header2" class="container-fluid">
		<nav class="nav navbar navbar-expand-md">
			<div class="row">
				<div class="col-10">
					<a href="" class="navbar-brand">
						<img src="IMAGENS/logo.png" class="img-fluid">
					</a>
				</div>

				<div class="col-2 align-self-center">
					<button class="btn btn-nav" type="button" data-bs-toggle="collapse" data-bs-target="#nav-burguer" aria-expanded="false" aria-controls="nav-burguer"><i class="fa-solid fa-bars"></i></button>
				</div>

				<div class="col-12">
					<div class="collapse" id="nav-burguer">
						<ul class="navbar-nav mt-3">
							<li class="nav-item"><a href="" class="col-12 d-flex justify-content-center nav-link">Premium</a></li>
							<li class="nav-item"><a href="" class="col-12 d-flex justify-content-center nav-link">Ajuda</a></li>
							<li class="nav-item"><a href="" class="col-12 d-flex justify-content-center nav-link">Baixar</a></li>

							<li class="nav-item divisor"></li>

							<li class="nav-item"><a href="" class="col-12 d-flex justify-content-center nav-link">Inscrever-se</a></li>
							<li class="nav-item"><a href="" class="col-12 d-flex justify-content-center nav-link">Entrar</a></li>
						</ul>
					</div>
				</div>
			</div>
		</nav>
	</header>

	<section class="container p-3">
		<h1 class="text-white">Procure a letra da sua música favorita!</h1>
		<div class="p-2 row">
			<div class="col-md-5"><input class="form-control" id="artista" placeholder="Digite aqui o artista"></div>
			<div class="col-md-5"><input class="form-control" id="musica" placeholder="Digite aqui a música"></div>
			<div class="col-md-2"><button class="btn" onclick="pesquisar()">Pesquisar</button></div>
		</div>

		<div id="conteudo" class="d-none mt-2 p-4">
			<h1 id="titulo"></h1>
			<h4 id="artista"></h4>
			<br>
			<div class="row">
				<div class="col-6"> <h5>Letra</h5> <p id="letra"></p> </div>
				<div id="titulo_traducao" class="col-6"> <h5>Tradução</h5> <p id="traducao"></p> </div>
			</div>
		</div>
	</section>

	<footer class="container-fluid">
		<div class="row d-flex justify-content-around">
			<div class="col-md-3 col-6">
				<img src="imagens/logo.png" class="img-fluid">
			</div>

			<div class="col-md-2 col-6">
				<h4>Company</h4>
				<ul class="navbar-nav">
					<li><a class="nav-link" href="">Sobre</a></li>
					<li><a class="nav-link" href="">Empregos</a></li>
					<li><a class="nav-link" href="">Imprensa</a></li>
					<li><a class="nav-link" href="">Novidade</a></li>
				</ul>
			</div>

			<div class="col-md-2 col-6">
				<h4>Comunidades</h4>
				<ul class="navbar-nav">
					<li><a class="nav-link" href="">Artista</a></li>
					<li><a class="nav-link" href="">Desenvolvedores</a></li>
					<li><a class="nav-link" href="">Marcas</a></li>
				</ul>
			</div>

			<div class="col-md-2 col-6">
				<h4>Links Úteis</h4>
				<ul class="navbar-nav">
					<li class="nav-item"><a class="nav-link" href="">Ajuda</a></li>
					<li><a class="nav-link" href="">Presentes</a></li>
					<li><a class="nav-link" href="">Player da Web</a></li>
				</ul>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		
		function pesquisar() {
			let artista = document.getElementById('artista').value
			let musica = document.getElementById('musica').value

			//API from https://api.vagalume.com.br/docs/letras/
			let url = 'https://api.vagalume.com.br/search.php?art='+ artista + '&mus='+ musica;
			url = url.replace(' ', '%20')
			
			xmlHttp = new XMLHttpRequest();
			xmlHttp.open('GET', url);

			xmlHttp.onreadystatechange = () => {
				if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
					let dadosJSONtext = xmlHttp.responseText;

					let dadosJSONobj = JSON.parse(dadosJSONtext);

					if (dadosJSONobj['type'] == 'notfound' || dadosJSONobj['type'] == "song_notfound") {
						alert('Música não encontrada')
					}

					console.log(dadosJSONobj)

					document.getElementById('conteudo').className = 'mt-2 p-4'

					document.getElementById('titulo').innerHTML = dadosJSONobj['mus'][0]['name']
					document.getElementById('cantor').innerHTML = dadosJSONobj['art']['name']

					if (dadosJSONobj['mus'][0]['translate']) {
						var string1 = dadosJSONobj['mus'][0]['translate'][0]['text']
						var string2 = dadosJSONobj['mus'][0]['text']
					} else {
						var string2 = dadosJSONobj['mus'][0]['text']
					}

					function nl2br (str, replaceMode, isXhtml) {
					  var breakTag = (isXhtml) ? '<br />' : '<br>';
					  var replaceStr = (replaceMode) ? '$1'+ breakTag : '$1'+ breakTag +'$2';
					  return (str + '').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, replaceStr);
					}

					if (dadosJSONobj['mus'][0]['translate']) {
						document.getElementById('traducao').innerHTML = nl2br(string1)
						document.getElementById('letra').innerHTML = nl2br(string2)
					} else {
						document.getElementById('letra').innerHTML = nl2br(string2)
						document.getElementById('titulo_traducao').className = 'd-none'
					}
				}
			}

			xmlHttp.send();
		}

	</script>

</body>
</html>